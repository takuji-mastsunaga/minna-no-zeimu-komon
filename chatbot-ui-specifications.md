# みんなの税務顧問 - チャットボット UI仕様書

## 概要
現在のchatbot.htmlから抽出したUI設計・インタラクション仕様を平面化し、新しいチャットボット開発用のリファレンスとして整理。

---

## 全体レイアウト構成

### ページ構造
```
Header（ナビゲーション）
├── ロゴ: みんなの税務顧問
├── メニュー: サービス内容 | 料金 | コスト比較
└── CTA: 申込はこちら

Main Content Area
├── 中央メッセージエリア
│   ├── タイトル: チャットサポート
│   ├── 説明文: 税務に関するご質問にお答えします
│   └── 開始ボタン: チャットを開始
└── チャットボット（LINE風UI）

Floating Elements
├── フローティングチャットボタン
└── チャットオーバーレイ
```

---

## LINE風チャットボットUI

### 1. フローティングチャットボタン
```css
位置: 固定（右下）
サイズ: padding: 15px 25px
背景: グラデーション（#14b8a6 → #0891b2）
形状: 角丸50px
アニメーション: pulse（2秒周期）
要素:
  ├── アイコン: 💬 (24px)
  └── テキスト: "お問い合わせはこちら" (14px)

モバイル対応:
  └── テキスト非表示、アイコンのみ
```

### 2. チャットウィンドウ全体
```css
位置: 固定（右下、ボタンの上）
サイズ: 380px × 600px
形状: 角丸20px
背景: 白色
シャドウ: 0 8px 32px rgba(0,0,0,0.12)
境界線: 1px solid #e5e5e5

モバイル対応:
  ├── 幅: calc(100vw - 20px)
  ├── 高さ: 500px
  └── 位置調整: right: 10px, bottom: 80px
```

### 3. チャットヘッダー
```css
背景: 白色
境界線: 下側に1px solid #e5e5e5
余白: 12px 16px
高さ: 60px

構成要素:
├── アイコン部分
│   ├── サイズ: 40px × 40px
│   ├── 背景: グラデーション（#14b8a6 → #0891b2）
│   ├── 形状: 角丸8px
│   └── アイコン: 💼 (20px, 白色)
├── ビジネス情報
│   ├── 名前: "みんなの税務顧問" (16px, 太字)
│   └── ステータス: "🟢 オンライン" (12px, グレー)
└── 閉じるボタン
    ├── サイズ: 32px × 32px
    ├── 背景: #f5f5f5
    ├── 形状: 角丸16px
    └── アイコン: ✕ (16px)
```

### 4. メッセージエリア
```css
背景: #f7f7f7
余白: 16px
スクロール: 縦方向のみ
Flex: 1（高さ自動調整）

メッセージバブル:
├── ボット（左寄せ）
│   ├── 背景: 白色
│   ├── 境界線: 1px solid #e5e5e5
│   ├── 形状: 角丸16px（左下は4px）
│   └── 文字色: #333333
└── ユーザー（右寄せ）
    ├── 背景: #14b8a6
    ├── 形状: 角丸16px（右下は4px）
    └── 文字色: 白色

共通設定:
├── 最大幅: 80%
├── 余白: 8px 12px
├── フォントサイズ: 14px
└── 行間: 1.4
```

### 5. ウェルカムビジネスカード
```css
構成:
├── ヘッダー部分
│   ├── 背景: グラデーション（#14b8a6 → #0891b2）
│   ├── 余白: 16px
│   ├── アイコン: 💼 (18px, 半透明白背景)
│   ├── タイトル: "みんなの税務顧問" (16px, 白色, 太字)
│   └── 説明: "税務のプロがサポートします" (13px, 半透明白)
└── コンテンツ部分
    ├── 背景: 白色
    ├── 余白: 16px
    ├── メッセージ1: "🎉 こんにちは！税務に関するご質問にお答えします。"
    └── メッセージ2: "💡 下のメニューからお選びいただくか、直接メッセージをお送りください。"
```

### 6. ボトムメニュー（4つのアイコンメニュー）
```css
背景: 白色
境界線: 上側に1px solid #e5e5e5
余白: 12px 8px 8px 8px

メニュー項目（4つ均等配置）:
├── サービス
│   ├── アイコン: 📋 (20px)
│   └── ラベル: "サービス" (10px, #666666)
├── 料金
│   ├── アイコン: 💰 (20px)
│   └── ラベル: "料金" (10px, #666666)
├── よくある質問
│   ├── アイコン: ❓ (20px)
│   └── ラベル: "よくある質問" (10px, #666666)
└── お問い合わせ
    ├── アイコン: 📞 (20px)
    └── ラベル: "お問い合わせ" (10px, #666666)

インタラクション:
├── ホバー: 背景 #f5f5f5
├── アクティブ: 背景 #e8f5f3
└── クリック: メニューコンテンツ表示
```

### 7. チャット入力エリア
```css
背景: 白色
境界線: 上側に1px solid #e5e5e5
余白: 12px 16px

入力ラッパー:
├── 背景: #f5f5f5
├── 形状: 角丸20px
├── 余白: 8px 12px
└── 構成: Flex（入力欄 + 送信ボタン）

入力欄:
├── 背景: 透明
├── 境界線: なし
├── フォントサイズ: 14px
├── プレースホルダー: "メッセージを入力"
└── 文字色: #333333

送信ボタン:
├── 背景: #14b8a6
├── 形状: 円形（32px × 32px）
├── アイコン: 送信矢印（白色）
└── ホバー: #0891b2
```

---

## メニューコンテンツUI

### メニューカード共通仕様
```css
背景: 白色
境界線: 1px solid #e5e5e5
形状: 角丸8px
余白: 12px
構成: Flex（アイコン + テキスト部分）
間隔: 12px

ホバーエフェクト:
├── 背景: #f8f9fa
├── 境界線: #14b8a6
├── 移動: translateY(-1px)
└── シャドウ: 0 2px 8px rgba(20,184,166,0.1)

アイコン部分:
├── サイズ: 20px
└── 位置: 固定（縮小なし）

テキスト部分:
├── タイトル: 14px, 太字, #333333
├── 説明: 12px, #666666
└── 行間: 1.3
```

### サービスメニュー
```
1. サービス概要
   ├── アイコン: 📋
   ├── タイトル: "サービス概要"
   ├── 説明: "税務顧問サービスの詳細"
   └── アクション: "サービス内容を教えて"

2. 当社の特徴
   ├── アイコン: 📊
   ├── タイトル: "当社の特徴"
   ├── 説明: "他社との違いとメリット"
   └── アクション: "他の税理士事務所との違いは？"

3. サポート体制
   ├── アイコン: 🤝
   ├── タイトル: "サポート体制"
   ├── 説明: "担当者による対応について"
   └── アクション: "AIが対応するの？"
```

### 料金メニュー
```
1. 基本料金
   ├── アイコン: 💰
   ├── タイトル: "基本料金"
   ├── 説明: "月額・年額プランの詳細"
   └── アクション: "料金について教えて"

2. 料金比較
   ├── アイコン: 📊
   ├── タイトル: "料金比較"
   ├── 説明: "プラン別料金の比較表"
   └── アクション: 新しいタブで /cost を開く

3. お支払い方法
   ├── アイコン: 💳
   ├── タイトル: "お支払い方法"
   ├── 説明: "決済方法と契約期間"
   └── アクション: "支払い方法について"
```

### よくある質問メニュー
```
1. 確定申告
   ├── アイコン: 📄
   ├── タイトル: "確定申告"
   ├── 説明: "申告の流れと期限"
   └── アクション: "確定申告について"

2. 消費税申告
   ├── アイコン: 💹
   ├── タイトル: "消費税申告"
   ├── 説明: "申告要否の判定"
   └── アクション: "消費税申告が必要か？"

3. 書類の管理
   ├── アイコン: 📋
   ├── タイトル: "書類の管理"
   ├── 説明: "領収書・資料の取扱い"
   └── アクション: "領収書の撮影方法は？"
```

### お問い合わせメニュー
```
1. お申し込み
   ├── アイコン: 📝
   ├── タイトル: "お申し込み"
   ├── 説明: "サービス申込フォーム"
   └── アクション: 新しいタブで /#contact を開く

2. サービス詳細
   ├── アイコン: ℹ️
   ├── タイトル: "サービス詳細"
   ├── 説明: "サービス内容の詳細"
   └── アクション: "サービス内容について詳しく教えて"

3. 運営会社
   ├── アイコン: 🏢
   ├── タイトル: "運営会社"
   ├── 説明: "ソルビス税理士法人について"
   └── アクション: "運営会社について教えて"
```

---

## インタラクション仕様

### 1. チャット開閉制御
```javascript
開く動作:
├── フローティングボタンクリック
├── 中央の「チャットを開始」ボタンクリック
├── チャットウィンドウ表示（display: flex）
├── アニメーション（0.3秒でtranslateY(0), opacity: 1）
├── オーバーレイ表示
├── フローティングボタン非表示
└── ウェルカムメッセージ表示

閉じる動作:
├── ヘッダーの閉じるボタンクリック
├── オーバーレイクリック
├── アニメーション（0.3秒でtranslateY(20px), opacity: 0）
├── チャットウィンドウ非表示（display: none）
├── オーバーレイ非表示
└── フローティングボタン表示
```

### 2. メッセージ送信フロー
```javascript
ユーザー入力:
├── 入力欄でEnterキー or 送信ボタンクリック
├── 入力内容検証（空文字チェック）
├── ウェルカムメッセージ非表示
├── ユーザーメッセージ表示
├── 入力欄クリア
├── ボット応答生成（0.8-1.2秒遅延）
├── ボットメッセージ表示
└── チャット履歴更新
```

### 3. FAQ応答システム
```javascript
キーワードマッチング:
├── 完全一致検索（faqDatabase のキー）
├── 部分マッチング検索（contains）
├── カテゴリ別応答フォーマット適用
├── 改行・絵文字の正規化
└── デフォルト応答（マッチしない場合）

応答フォーマット:
├── カテゴリラベル追加 "【○○について】"
├── 絵文字の統一化（・に変換）
├── 金額表示の改行調整
├── 箇条書きの改行調整
└── 読みやすさ優先の整形
```

### 4. メニューシステム
```javascript
メニューアイテムクリック:
├── アクティブ状態の更新（.active クラス）
├── メニュー内容の動的生成
├── メニューカードのHTML生成
├── ボットメッセージとして表示
└── 各カードにクリックイベント設定

カードクリック処理:
├── クイック質問の場合 → sendQuickQuestion()
├── 外部リンクの場合 → window.open()
└── 新しいタブで安全に開く設定
```

---

## アニメーション仕様

### 1. 基本アニメーション
```css
/* フローティングボタンのパルス */
@keyframes pulse {
  0%   { box-shadow: 0 8px 25px rgba(20,184,166,0.3); }
  50%  { box-shadow: 0 8px 25px rgba(20,184,166,0.6); }
  100% { box-shadow: 0 8px 25px rgba(20,184,166,0.3); }
}

/* メッセージのスライドアップ */
@keyframes slideInUp {
  from { opacity: 0; transform: translateY(10px); }
  to   { opacity: 1; transform: translateY(0); }
}
```

### 2. トランジション設定
```css
共通トランジション:
├── チャットウィンドウ: all 0.3s cubic-bezier(0.4,0,0.2,1)
├── メニューカード: all 0.2s ease
├── ボタン類: all 0.3s ease
└── ホバーエフェクト: transform 0.2s ease
```

---

## レスポンシブ対応

### ブレークポイント
```css
デスクトップ: 769px以上
├── チャットウィンドウ: 380px × 600px
├── フローティングボタン: テキスト表示
└── 全機能利用可能

モバイル: 768px以下
├── チャットウィンドウ: calc(100vw - 20px) × 500px
├── 位置調整: right: 10px, bottom: 80px
├── フローティングボタン: アイコンのみ
└── タッチ操作最適化
```

---

## 色彩仕様

### メインカラーパレット
```css
プライマリ:
├── ティール: #14b8a6
├── ブルー: #0891b2
└── グラデーション: linear-gradient(135deg, #14b8a6, #0891b2)

セカンダリ:
├── ダークグレー: #1f2937
├── ミディアムグレー: #6b7280
├── ライトグレー: #f7f7f7
└── 境界線グレー: #e5e5e5

アクセント:
├── ホワイト: #ffffff
├── アクティブ背景: #e8f5f3
└── ホバー背景: #f8f9fa
```

### 状態別カラー
```css
通常状態:
├── テキスト: #333333
├── 説明文: #666666
└── プレースホルダー: #999999

インタラクション:
├── ホバー: #f5f5f5
├── アクティブ: #e8f5f3
└── フォーカス: #14b8a6

メッセージバブル:
├── ユーザー: #14b8a6 (白文字)
├── ボット: #ffffff (黒文字)
└── 境界線: #e5e5e5
```

---

## 実装に必要な主要機能

### JavaScript関数一覧
```javascript
チャット制御:
├── toggleChatSupport() - チャット開閉
├── closeChatSupport() - チャット閉じる
└── initializeChat() - 初期化

メッセージ処理:
├── sendMessage() - メッセージ送信
├── addMessage() - メッセージ追加
├── addBotMessage() - ボット専用メッセージ
└── generateBotResponse() - 応答生成

メニューシステム:
├── showMenuContent() - メニュー表示
├── sendQuickQuestion() - クイック質問
└── handleInputKeydown() - キーボード処理

応答システム:
├── findBestResponse() - 最適応答検索
├── formatLineResponse() - 応答フォーマット
└── formatDefaultResponse() - デフォルト応答
```

### データ構造
```javascript
FAQ データベース:
{
  "キーワード": {
    answer: "回答内容",
    category: "カテゴリ"
  }
}

チャット履歴:
[
  {
    type: "user" | "bot",
    message: "メッセージ内容",
    timestamp: Date
  }
]
```

---

## セキュリティ・パフォーマンス考慮

### セキュリティ
- XSS対策: innerHTML使用時のサニタイゼーション
- 外部リンク: rel="noopener noreferrer" 設定
- 入力検証: 空文字・特殊文字チェック

### パフォーマンス
- 遅延読み込み: 必要時のみDOM操作
- アニメーション最適化: transform使用
- メモリ管理: イベントリスナーの適切な管理

---

## 更新履歴
- 初版作成: chatbot.html からのUI仕様抽出
- 詳細化: 全コンポーネントの仕様明文化
- 体系化: 実装に必要な全情報の整理完了

