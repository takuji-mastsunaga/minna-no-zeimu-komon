<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>【テスト版】契約までの確認事項</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Hiragino Sans","Noto Sans JP",sans-serif;background:#F0F4F8;min-height:100vh}
    .container{max-width:800px;width:100%;margin:0 auto;background:#fff;min-height:100vh;box-shadow:0 0 20px rgba(0,0,0,.05)}
    .header{background:#fff;padding:20px 15px;text-align:center;border-bottom:1px solid #E5E7EB;position:sticky;top:0;z-index:100}
    .header h1{font-size:18px;color:#1F2937;font-weight:600}
    .header .test-badge{display:inline-block;background:#EF4444;color:#fff;padding:4px 12px;border-radius:4px;font-size:12px;font-weight:700;margin-left:8px;}
    .content{padding:40px;min-height:500px;max-width:720px;margin:0 auto}
    @media (min-width:1024px){.content{padding:60px 40px}.industry-grid{grid-template-columns:repeat(2,1fr);max-width:600px;margin:20px auto}.price-plans{max-width:600px;margin:30px auto}.final-options{max-width:600px;margin:30px auto}.price-summary{max-width:600px;margin:30px auto}.option-card{max-width:600px;margin-left:auto;margin-right:auto}.input-group{max-width:500px;margin-left:auto;margin-right:auto;margin-bottom:20px}}
    .step{display:none;animation:fadeIn .4s ease}.step.active{display:block}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    .question{font-size:22px;color:#1F2937;margin-bottom:8px;font-weight:600;text-align:center}
    .sub-text{text-align:center;color:#6B7280;font-size:14px;margin-bottom:30px}
    .sub-text::before{content:"※";margin-right:4px}
    .option-card{background:#fff;border:2px solid #E0F2F1;border-radius:12px;padding:20px;margin-bottom:15px;cursor:pointer;transition:.3s ease;position:relative;display:flex;align-items:center;justify-content:space-between}
    .option-card:hover{border-color:#26A69A;background:#F0FDF9}
    .option-card.selected{background:#E6FFFA;border-color:#26A69A}
    .option-card.disabled{opacity:.6;cursor:not-allowed}
    .option-card.info-only{cursor:default;background:#fff;border-color:#E5E7EB}
    .option-card.info-only .option-text{font-size:14px;color:#6B7280}
    .option-card.info-only .option-text strong{font-size:14px;color:#374151}
    .option-card.info-only .option-text small{font-size:12px;color:#6B7280}
    .option-text{flex:1;font-size:16px;color:#374151;display:flex;align-items:center;gap:10px}
    .info-btn{width:32px;height:32px;border-radius:50%;border:2px solid #E0F2F1;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.3s ease;color:#9CA3AF;font-size:16px;font-weight:700;flex-shrink:0}
    .info-btn:hover{background:#26A69A;color:#fff;border-color:#26A69A}
    .info-tooltip{display:none;position:absolute;right:50px;top:50%;transform:translateY(-50%);background:#fff;border:2px solid #E0F2F1;border-radius:12px;padding:15px;width:300px;box-shadow:0 10px 25px rgba(0,0,0,.1);z-index:1000}
    .info-tooltip.show{display:block;animation:tooltipFadeIn .3s ease}
    .info-tooltip h4{color:#26A69A;margin-bottom:8px;font-size:14px}
    .info-tooltip p{color:#6B7280;font-size:13px;line-height:1.6}
    .checkbox-wrapper{display:flex;align-items:center;width:100%}
    .checkbox-wrapper input[type="checkbox"]{width:20px;height:20px;margin-right:12px;cursor:pointer;accent-color:#26A69A}
    .checkbox-wrapper label{cursor:pointer;color:#374151;font-size:15px;user-select:none;flex:1}
    .input-group{margin-bottom:20px}
    .input-group label{display:block;margin-bottom:8px;font-weight:600;color:#374151;font-size:14px}
    .input-group input{width:100%;padding:12px 16px;border:2px solid #E0F2F1;border-radius:8px;font-size:16px;transition:.3s ease;background:#fff}
    .invoice-input-group{margin-bottom:20px;max-width:500px;margin-left:auto;margin-right:auto}
    .invoice-input-wrapper{display:flex;align-items:center;border:2px solid #E0F2F1;border-radius:8px;overflow:hidden;transition:.3s ease}
    .invoice-input-wrapper:focus-within{border-color:#26A69A;box-shadow:0 0 0 3px rgba(38,166,154,.1)}
    .invoice-prefix{background:#F3F4F6;padding:12px 16px;font-size:16px;font-weight:600;color:#374151;border-right:1px solid #E5E7EB}
    .invoice-input-wrapper input{flex:1;padding:12px 16px;border:none;font-size:16px;background:#fff;outline:none}
    .btn-group{display:flex;flex-direction:column;gap:15px;margin-top:40px;align-items:center}
    .btn-group-top{display:flex;gap:15px;justify-content:center;flex-wrap:wrap}
    .btn{padding:14px 32px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:.3s ease;min-width:140px}
    .btn-primary{background:#26A69A;color:#fff}.btn-primary:hover{background:#00897B;transform:translateY(-2px);box-shadow:0 8px 20px rgba(38,166,154,.3)}
    .btn-secondary{background:#6B7280;color:#fff}.btn-secondary:hover{background:#4B5563}
    .btn-back{background:#fff;color:#6B7280;border:2px solid #E5E7EB}.btn-back:hover{background:#F9FAFB}
    .warning-box{background:#FEF3C7;border-left:4px solid #F59E0B;padding:15px;border-radius:8px;margin:20px 0}
    .error-box{background:#FEE2E2;border-left:4px solid #EF4444;padding:20px;border-radius:8px;text-align:center}
    .success-box{background:#D1FAE5;border-left:4px solid #10B981;padding:15px;border-radius:8px;margin:20px 0}
    .industry-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:15px;margin:20px 0}
    .industry-item{background:#fff;border:2px solid #E0F2F1;border-radius:12px;padding:15px;cursor:pointer;transition:.3s ease}
    .industry-item:hover{border-color:#26A69A;background:#F0FDF9}
    .industry-item.selected{background:#E6FFFA;border-color:#26A69A}
    .industry-item strong{display:block;color:#1F2937;margin-bottom:4px}
    .industry-item small{color:#6B7280;font-size:12px}
    .price-summary{background:linear-gradient(135deg,#F0FDF9 0%,#E6FFFA 100%);border-radius:12px;padding:25px;margin:30px 0}
    .price-summary h2{color:#1F2937;margin-bottom:20px;font-size:20px}
    .price-item{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(0,0,0,.08)}
    .price-item:last-child{border-bottom:none;padding-top:20px;margin-top:10px;border-top:2px solid rgba(38,166,154,.3);font-weight:700;font-size:18px}
    .price-plans{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin:30px 0}
    .plan-card{background:#fff;border:2px solid #E0F2F1;border-radius:12px;padding:25px;text-align:center;cursor:pointer;transition:.3s ease}
    .plan-card:hover{border-color:#26A69A;transform:translateY(-5px);box-shadow:0 10px 30px rgba(0,0,0,.1)}
    .plan-card.selected{border-color:#26A69A;background:#E6FFFA}
    .plan-card h3{color:#1F2937;margin-bottom:15px}
    .plan-price{font-size:28px;color:#26A69A;font-weight:700;margin-bottom:10px}
    .plan-price small{font-size:14px;color:#6B7280}
    .plan-total{color:#6B7280;font-size:14px;margin-top:10px}
    .final-options{margin:30px 0}
    .final-options h3{color:#1F2937;margin-bottom:20px}
    .option-with-input{display:flex;align-items:center;gap:15px;margin-left:35px;margin-top:10px}
    .option-with-input input[type="number"]{width:100px;padding:8px;border:2px solid #E0F2F1;border-radius:6px}
    @media (max-width:640px){.content{padding:25px}.industry-grid{grid-template-columns:1fr}.info-tooltip{width:250px;right:40px}}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>契約までの確認事項<span class="test-badge">テスト版</span></h1>
      <p>申告に必要な情報を入力をお願いいたします。</p>
    </div>

    <div class="content">
      <!-- 以下、本番版と同じコンテンツ -->
      <!-- Step 0からの内容は本番版と同じなので省略 -->
      <!-- ... （実際には全てのステップが含まれます）... -->
      <div class="step active" id="step0">
        <div class="question">【テスト環境】利用規約</div>
        <div class="warning-box">
          <strong>⚠️ テスト環境です</strong><br>
          これはテスト用のページです。本番の決済は行われません。<br>
          テスト用のStripe APIキーを使用しています。
        </div>
        <div class="option-card info-only">
          <div class="option-text">
            <div>
              <strong>本システムのご利用について</strong><br>
              <small style="color:#6B7280;line-height:1.6;">
                青色申告・白色申告の判定を行い、適切な税務申告をサポートします。<br>
                入力された情報は決済完了まで保存されませんので、ご安心ください。
              </small>
            </div>
          </div>
        </div>
        <div class="btn-group">
          <button class="btn btn-primary" onclick="acceptTerms()">同意して進む</button>
        </div>
      </div>

      <!-- エラー画面 -->
      <div class="step" id="step-error">
        <div class="error-box">
          <h3>申し訳ございません</h3>
          <p id="errorMessage">弊社ではお受けできません。</p>
        </div>
        <div class="warning-box" style="margin:20px auto;max-width:500px;">
          <strong>⚠️ ご注意</strong><br>
          前の画面に戻って回答を変更される場合は、正確な情報をご入力ください。虚偽の申告は利用規約違反となります。
        </div>
        <div class="btn-group">
          <div class="btn-group-top">
            <button class="btn btn-back" onclick="goBackWithWarning()">一つ前に戻る</button>
            <button class="btn btn-secondary" onclick="restart()">最初から始める</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========== GAS Web App URL (TEST VERSION - v33) ==========
  const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbx56HIAEoHu5crtrLtBKf6Ri0V_UrofleO-RpQTRM7PlwEY8nnr2l9bsiB1COgHlTEGfw/exec'; // 🧪 テスト用 v1
  
  console.log('🧪 テスト環境で実行中');

    const appState = {
      currentStep: 0, stepHistory: [],
      entityType: null, declarationType: null,
      hasInvoice: false, invoiceNumber: null,
      industries: [], hasTaxObligation: false,
      selectedPlan: null, selectedOptions: {},
      totalPrice: 0, basePrice: 0,
      hasDependent: false, hasDirector: false,
      isYearEndPeriod: false, hasSalaryIncome: false,
      fromEmployeeWithholding: false
    };

    function checkContractPeriod() {
      const month = new Date().getMonth();
      appState.isYearEndPeriod = (month === 11);
      return !appState.isYearEndPeriod;
    }
    function updateProgress(){}

    function showStep(id){
      document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      appState.currentStep++; updateProgress();
    }
    function goBack(){
      if(appState.stepHistory.length>0){
        const prev = appState.stepHistory.pop();
        document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));
        document.getElementById(prev).classList.add('active');
        appState.currentStep--; updateProgress();
      }
    }
    function goBackWithWarning(){
      if(confirm('前の画面に戻りますが、正確な情報を入力してください。\n虚偽の申告は利用規約違反となります。\n\n前の画面に戻りますか？')) goBack();
    }
    function showInfo(btn){
      const tip = btn.nextElementSibling;
      document.querySelectorAll('.info-tooltip').forEach(t=>{ if(t!==tip) t.classList.remove('show');});
      tip.classList.toggle('show');
    }
    document.addEventListener('click',e=>{
      if(!e.target.closest('.info-btn')) document.querySelectorAll('.info-tooltip').forEach(t=>t.classList.remove('show'));
    });

    function acceptTerms(){ appState.stepHistory.push('step0'); alert('【テスト環境】\n\nこれはテスト用のフォームです。\n実際の決済は行われません。'); /* showStep('step1'); */ }

    function restart(){
      location.reload();
    }

    // ========== ページ初期化処理 ==========
    window.addEventListener('DOMContentLoaded', function() {
      console.log('🧪 テスト版 LP1 読み込み完了');
      console.log('GAS API URL:', GAS_API_URL);
      
      // テスト環境の警告を表示
      const testWarning = document.createElement('div');
      testWarning.style.cssText = 'position:fixed;bottom:20px;right:20px;background:#EF4444;color:#fff;padding:12px 20px;border-radius:8px;font-weight:700;z-index:9999;box-shadow:0 4px 12px rgba(0,0,0,0.2);';
      testWarning.textContent = '🧪 テスト環境';
      document.body.appendChild(testWarning);
    });
  </script>
</body>
</html>



