# スプレッドシート列定義書（AG-AW列）

## 📋 概要

LP2（詳細情報入力ページ）で収集されるデータを保存するための、Google Sheetsの列定義。

---

## 📊 masterシート 全体構成

### 既存列（A-AF列）

| 列 | 列名 | データ例 | 備考 |
|----|------|---------|------|
| A | UUID | 947d7c33-1373-4999-9cb2-8f757feff73f | 一意識別子 |
| B | entityType | individual / corporate | 個人 / 法人 |
| C | 姓 | 山田 | LP1入力 |
| D | 名 | 太郎 | LP1入力 |
| E | メールアドレス | test@example.com | LP1入力 |
| F-AB | LP1入力データ | ... | その他LP1フォーム項目 |
| AC | Stripe Customer ID | cus_xxx | 決済完了時 |
| AD | Subscription ID | sub_xxx | 決済完了時 |
| AE | Payment Intent ID | pi_xxx | 決済完了時 |
| AF | 決済日時 | 2025-10-27T01:32:11Z | 決済完了時 |

### 新規追加列（AG-AW列）: LP2データ

| 列 | 列名 | 個人 | 法人 | データ型 | 備考 |
|----|------|------|------|---------|------|
| **AG** | **法人名** | （空欄） | ✅ 入力 | テキスト | 法人のみ |
| **AH** | **法人郵便番号** | （空欄） | ✅ 入力 | テキスト（7桁） | 法人のみ、ハイフンなし |
| **AI** | **法人住所** | （空欄） | ✅ 入力 | テキスト | 法人のみ |
| **AJ** | **代表者名/名前** | ✅ 入力 | ✅ 入力 | テキスト | 個人:名前、法人:代表者名 |
| **AK** | **フリガナ** | ✅ 入力 | ✅ 入力 | テキスト（カタカナ） | カタカナのみ |
| **AL** | **代表者郵便番号/郵便番号** | ✅ 入力 | ✅ 入力 | テキスト（7桁） | ハイフンなし |
| **AM** | **代表者住所/住所** | ✅ 入力 | ✅ 入力 | テキスト | 詳細住所 |
| **AN** | **e-tax利用者識別番号** | ✅ 入力 | ✅ 入力 | テキスト（16桁） | 数字16桁 |
| **AO** | **e-tax暗証番号/パスワード** | ✅ 入力 | ✅ 入力 | テキスト | 個人:パスワード、法人:暗証番号 |
| **AP** | **e-Ltax利用者ID** | （空欄） | ✅ 入力 | テキスト | 法人のみ |
| **AQ** | **e-Ltax暗証番号** | （空欄） | ✅ 入力 | テキスト | 法人のみ |
| **AR** | **会計ソフト使用状況** | ✅ 入力 | ✅ 入力 | テキスト | 「使用している」/「使用していない」 |
| **AS** | **使用会計ソフト名** | 条件付き | 条件付き | テキスト | ARが「使用している」の場合のみ |
| **AT** | **その他会計ソフト名** | 条件付き | 条件付き | テキスト | ASが「その他」の場合のみ |
| **AU** | **クラウド会計メールアドレス** | ✅ 入力 | ✅ 入力 | テキスト | メール形式 |
| **AV** | **LP2入力完了フラグ** | 自動 | 自動 | ブール値 | TRUE/FALSE |
| **AW** | **LP2入力日時** | 自動 | 自動 | 日時 | タイムスタンプ |

---

## 📝 詳細仕様

### AG列: 法人名

**データ型**: テキスト  
**個人**: 空欄  
**法人**: 必須入力

**データ例**:
- `株式会社テスト`
- `合同会社サンプル`
- `テスト商事株式会社`

**バリデーション**:
- 1文字以上

---

### AH列: 法人郵便番号

**データ型**: テキスト（7桁）  
**個人**: 空欄  
**法人**: 必須入力

**データ例**:
- `1000001`
- `5400001`

**バリデーション**:
- 数字7桁
- ハイフンなし

---

### AI列: 法人住所

**データ型**: テキスト  
**個人**: 空欄  
**法人**: 必須入力

**データ例**:
- `東京都千代田区丸の内1-1-1`
- `大阪府大阪市北区梅田3-1-3`

**バリデーション**:
- 1文字以上

---

### AJ列: 代表者名/名前

**データ型**: テキスト  
**個人**: 必須入力（名前）  
**法人**: 必須入力（代表者名）

**データ例**:
- 個人: `山田太郎`
- 法人: `鈴木一郎`

**バリデーション**:
- 1文字以上

**備考**:
- 個人の場合は、本人の名前
- 法人の場合は、代表者（社長など）の名前

---

### AK列: フリガナ

**データ型**: テキスト（カタカナ）  
**個人**: 必須入力  
**法人**: 必須入力

**データ例**:
- `ヤマダタロウ`
- `スズキイチロウ`

**バリデーション**:
- カタカナのみ
- 1文字以上

**備考**:
- 全角カタカナで入力
- AJ列の名前のフリガナ

---

### AL列: 代表者郵便番号/郵便番号

**データ型**: テキスト（7桁）  
**個人**: 必須入力（郵便番号）  
**法人**: 必須入力（代表者郵便番号）

**データ例**:
- `1000001`
- `5400001`

**バリデーション**:
- 数字7桁
- ハイフンなし

**備考**:
- 個人の場合は、本人の郵便番号
- 法人の場合は、代表者の郵便番号（法人住所とは別）

---

### AM列: 代表者住所/住所

**データ型**: テキスト  
**個人**: 必須入力（住所）  
**法人**: 必須入力（代表者住所）

**データ例**:
- `東京都千代田区丸の内1-1-1`
- `大阪府大阪市北区梅田3-1-3`

**バリデーション**:
- 1文字以上

**備考**:
- 個人の場合は、本人の住所
- 法人の場合は、代表者の住所（法人住所とは別）

---

### AN列: e-tax利用者識別番号

**データ型**: テキスト（16桁）  
**個人**: 必須入力  
**法人**: 必須入力

**データ例**:
- `1234567890123456`
- `9876543210987654`

**バリデーション**:
- 数字16桁
- ハイフンなし

**備考**:
- 国税電子申告・納税システム（e-Tax）の利用者識別番号
- 個人・法人ともに必須

---

### AO列: e-tax暗証番号/パスワード

**データ型**: テキスト  
**個人**: 必須入力（パスワード）  
**法人**: 必須入力（暗証番号）

**データ例**:
- `password123`
- `etax2025`

**バリデーション**:
- 1文字以上

**備考**:
- e-Taxログイン用のパスワード/暗証番号
- **セキュリティ注意**: 平文でGoogleシートに保存されます

---

### AP列: e-Ltax利用者ID

**データ型**: テキスト  
**個人**: 空欄  
**法人**: 必須入力

**データ例**:
- `eltax123456`
- `ltx987654321`

**バリデーション**:
- 1文字以上

**備考**:
- 地方税電子申告システム（eLTAX）の利用者ID
- 法人のみ必要

---

### AQ列: e-Ltax暗証番号

**データ型**: テキスト  
**個人**: 空欄  
**法人**: 必須入力

**データ例**:
- `eltaxpass123`
- `ltx2025`

**バリデーション**:
- 1文字以上

**備考**:
- eLTAXログイン用の暗証番号
- 法人のみ必要
- **セキュリティ注意**: 平文でGoogleシートに保存されます

---

### AR列: 会計ソフト使用状況

**データ型**: テキスト  
**個人**: 必須入力  
**法人**: 必須入力

**データ例**:
- `使用している`
- `使用していない`

**バリデーション**:
- 「使用している」または「使用していない」のいずれか

**備考**:
- LP2のラジオボタンで選択

---

### AS列: 使用会計ソフト名

**データ型**: テキスト  
**個人**: 条件付き（ARが「使用している」の場合のみ）  
**法人**: 条件付き（ARが「使用している」の場合のみ）

**データ例**:
- `マネーフォワード`
- `freee`
- `その他`

**バリデーション**:
- ARが「使用している」の場合は必須
- 「マネーフォワード」「freee」「その他」のいずれか

**備考**:
- LP2のセレクトボックスで選択

---

### AT列: その他会計ソフト名

**データ型**: テキスト  
**個人**: 条件付き（ASが「その他」の場合のみ）  
**法人**: 条件付き（ASが「その他」の場合のみ）

**データ例**:
- `弥生会計`
- `勘定奉行`
- `自社開発システム`

**バリデーション**:
- ASが「その他」の場合は必須
- 1文字以上

**備考**:
- LP2のテキストフィールドで自由入力

---

### AU列: クラウド会計メールアドレス

**データ型**: テキスト  
**個人**: 必須入力  
**法人**: 必須入力

**データ例**:
- `accounting@example.com`
- `test@test.com`

**バリデーション**:
- メール形式
- 1文字以上

**備考**:
- クラウド会計ソフトに登録しているメールアドレス
- 会計ソフトを使用していない場合でも入力必須

---

### AV列: LP2入力完了フラグ

**データ型**: ブール値  
**個人**: 自動設定  
**法人**: 自動設定

**データ例**:
- `TRUE`
- `FALSE`

**設定タイミング**:
- LP2データ保存時に自動的に`TRUE`に設定

**備考**:
- `TRUE`: LP2入力完了（再編集不可）
- `FALSE`または空欄: 未入力（入力可能）

---

### AW列: LP2入力日時

**データ型**: 日時  
**個人**: 自動設定  
**法人**: 自動設定

**データ例**:
- `2025-10-27 10:30:00`
- `2025-11-01 14:25:35`

**設定タイミング**:
- LP2データ保存時に自動的に現在日時を記録

**備考**:
- タイムスタンプ形式
- 監査・トラブルシューティング用

---

## 📋 データ入力パターン

### パターン1: 個人（会計ソフト使用）

| 列 | データ |
|----|--------|
| AG | （空欄） |
| AH | （空欄） |
| AI | （空欄） |
| AJ | 山田太郎 |
| AK | ヤマダタロウ |
| AL | 1000001 |
| AM | 東京都千代田区丸の内1-1-1 |
| AN | 1234567890123456 |
| AO | etaxpass123 |
| AP | （空欄） |
| AQ | （空欄） |
| AR | 使用している |
| AS | マネーフォワード |
| AT | （空欄） |
| AU | yamada@example.com |
| AV | TRUE |
| AW | 2025-10-27 10:30:00 |

---

### パターン2: 個人（会計ソフト不使用）

| 列 | データ |
|----|--------|
| AG | （空欄） |
| AH | （空欄） |
| AI | （空欄） |
| AJ | 鈴木花子 |
| AK | スズキハナコ |
| AL | 5400001 |
| AM | 大阪府大阪市中央区本町1-1-1 |
| AN | 9876543210987654 |
| AO | etaxpass456 |
| AP | （空欄） |
| AQ | （空欄） |
| AR | 使用していない |
| AS | （空欄） |
| AT | （空欄） |
| AU | suzuki@example.com |
| AV | TRUE |
| AW | 2025-10-27 11:00:00 |

---

### パターン3: 法人（会計ソフト使用：freee）

| 列 | データ |
|----|--------|
| AG | 株式会社テスト |
| AH | 1000001 |
| AI | 東京都千代田区丸の内1-1-1 |
| AJ | 佐藤一郎 |
| AK | サトウイチロウ |
| AL | 1000002 |
| AM | 東京都千代田区丸の内2-2-2 |
| AN | 1111222233334444 |
| AO | etaxcorp123 |
| AP | eltax123456 |
| AQ | eltaxpass789 |
| AR | 使用している |
| AS | freee |
| AT | （空欄） |
| AU | accounting@test-corp.com |
| AV | TRUE |
| AW | 2025-10-27 12:00:00 |

---

### パターン4: 法人（会計ソフト使用：その他）

| 列 | データ |
|----|--------|
| AG | 合同会社サンプル |
| AH | 5400001 |
| AI | 大阪府大阪市北区梅田3-1-3 |
| AJ | 田中二郎 |
| AK | タナカジロウ |
| AL | 5400002 |
| AM | 大阪府大阪市北区梅田4-4-4 |
| AN | 5555666677778888 |
| AO | etaxcorp456 |
| AP | eltax789012 |
| AQ | eltaxpass321 |
| AR | 使用している |
| AS | その他 |
| AT | 弥生会計 |
| AU | accounting@sample-llc.com |
| AV | TRUE |
| AW | 2025-10-27 13:00:00 |

---

## 🔒 セキュリティとプライバシー

### 機密情報の取り扱い

以下の列には機密情報が含まれます：

- **AO列**: e-tax暗証番号/パスワード
- **AQ列**: e-Ltax暗証番号

**現在の実装**:
- 平文でGoogleシートに保存

**推奨事項**:
- スプレッドシートのアクセス権限を厳密に管理
- 定期的にアクセスログを確認
- （オプション）暗号化を検討

### アクセス権限

- **閲覧**: 税理士、管理者のみ
- **編集**: 管理者のみ
- **削除**: 禁止（バックアップを含む）

---

## 📊 データ分析用ビュー（オプション）

### LP2入力状況確認ビュー

masterシートのデータをフィルタ・集計するためのビューを作成できます：

```
=QUERY(master!A:AW, "SELECT A, B, C, D, E, AV, AW WHERE AV = TRUE ORDER BY AW DESC")
```

**表示項目**:
- UUID
- entityType
- 姓
- 名
- メールアドレス
- LP2入力完了フラグ
- LP2入力日時

---

## 🧪 データ検証

### 自動検証（Googleシート機能）

以下の列にデータ検証ルールを設定できます：

#### AR列（会計ソフト使用状況）
- リストから選択: `使用している`, `使用していない`

#### AS列（使用会計ソフト名）
- リストから選択: `マネーフォワード`, `freee`, `その他`

#### AV列（LP2入力完了フラグ）
- チェックボックス: TRUE/FALSE

---

**作成日**: 2025年10月27日  
**バージョン**: 1.0  
**最終更新**: 2025年10月27日



